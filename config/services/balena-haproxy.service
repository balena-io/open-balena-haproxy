[Unit]
Description=balena-haproxy
Requires=confd.service
After=confd.service

[Service]
TimeoutSec=infinity
StandardOutput=journal+console
StandardError=journal+console
WorkingDirectory=/usr/src/app
EnvironmentFile=/etc/docker.env
ExecStartPre=/usr/src/app/bin/generate-config config -e PROXY_CONFIG
ExecStart=/usr/local/sbin/haproxy -f /usr/local/etc/haproxy/haproxy.cfg
Restart=always

[Install]
WantedBy=basic.target
